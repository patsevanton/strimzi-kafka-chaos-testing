# Helm values для чарта kafbat-ui/kafka-ui
# helm repo add kafbat-ui https://kafbat.github.io/helm-charts
# helm install kafka-ui kafbat-ui/kafka-ui -f helm/kafka-ui-values.yaml -n kafka-ui --create-namespace

image:
  tag: v1.4.2

# Конфигурация кластеров Kafka (адаптировано под kafka-cluster)
yamlApplicationConfig:
  kafka:
    clusters:
      - name: kafka-cluster
        bootstrapServers: kafka-cluster-kafka-bootstrap.kafka-cluster.svc.cluster.local:9092
        schemaRegistry: http://schema-registry.schema-registry.svc.cluster.local:8081
        defaultKeySerde: String
        defaultValueSerde: SchemaRegistry
        properties:
          security.protocol: SASL_PLAINTEXT
          sasl.mechanism: SCRAM-SHA-512
          sasl.jaas.config: org.apache.kafka.common.security.scram.ScramLoginModule required username="${KAFKA_USERNAME}" password="${KAFKA_PASSWORD}";
  auth:
    type: DISABLED
  management:
    health:
      ldap:
        enabled: false

# Переменные окружения для учётных данных (Secret kafka-ui-user создаётся Strimzi KafkaUser)
env:
  - name: KAFKA_USERNAME
    value: "kafka-ui-user"
  - name: KAFKA_PASSWORD
    valueFrom:
      secretKeyRef:
        name: kafka-ui-user
        key: password
  - name: DYNAMIC_CONFIG_ENABLED
    value: "true"
  - name: LOGGING_PATTERN_CONSOLE
    value: '{"time":"%d{yyyy-MM-dd HH:mm:ss.SSS}","level":"%p","logger":"%c","thread":"%t","msg":"%m"}%n'

resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "500m"

livenessProbe:
  httpGet:
    path: /actuator/health
    port: http
  initialDelaySeconds: 60
  periodSeconds: 30

readinessProbe:
  httpGet:
    path: /actuator/health
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10

ingress:
  enabled: true
  ingressClassName: nginx
  host: kafka-ui.apatsev.org.ru
  path: /
  pathType: Prefix
